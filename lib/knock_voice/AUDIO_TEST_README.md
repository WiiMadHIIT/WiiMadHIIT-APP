# 音频检测测试页面

## 概述

这是一个独立的音频检测测试页面，用于调试和验证音频检测功能，不会影响原有的 `real_audio_detector.dart` 文件。

## 文件结构

```
lib/
├── knock_voice/
│   ├── real_audio_detector.dart          # 原有的音频检测器（未修改）
│   ├── audio_test_helper.dart            # 音频测试辅助类
│   └── AUDIO_TEST_README.md              # 本说明文档
└── presentation/
    └── checkin_start_training/
        └── audio_test_page.dart          # 音频测试页面
```

## 功能特点

### 🎯 独立测试环境
- 完全独立的测试页面，不影响原有代码
- 使用相同的 `RealAudioDetector` 进行测试
- 提供详细的调试日志和实时监控

### 📊 实时监控
- 实时显示当前分贝值
- 击打次数统计
- 测试状态显示
- 详细的日志记录

### 🧪 测试功能
- 30秒自动测试
- 手动开始/停止测试
- 日志清理功能
- 自动滚动日志显示

## 使用方法

### 1. 访问测试页面
```dart
// 在应用中导航到测试页面
Navigator.pushNamed(context, AppRoutes.audioTest);
```

### 2. 运行测试
1. 点击 "Start Test" 按钮开始测试
2. 制造一些声音来测试击打检测
3. 观察实时分贝值和击打统计
4. 查看详细日志了解检测过程

### 3. 查看结果
- **Test Status**: 显示测试运行状态
- **Hit Count**: 显示检测到的击打次数
- **Current dB**: 显示当前分贝值
- **Test Logs**: 显示详细的调试日志

## 测试建议

### 开发阶段
1. **先使用测试页面**验证音频检测功能
2. **调整分贝阈值**等参数
3. **测试不同环境**下的检测效果
4. **验证编解码器兼容性**

### 生产环境
1. **移除测试页面路由**（可选）
2. **用户使用正常训练页面**进行训练
3. **保留测试页面**用于后续维护

## 日志说明

测试页面会显示以下类型的日志：

- 🎯 **蓝色**: 检测事件和状态更新
- ✅ **绿色**: 成功操作
- ❌ **红色**: 错误信息
- ⚠️ **橙色**: 警告信息
- 📊 **黑色**: 统计信息

## 注意事项

1. **权限要求**: 需要麦克风权限
2. **iOS兼容性**: 测试页面会显示编解码器降级过程
3. **资源管理**: 测试结束后会自动清理资源
4. **调试信息**: 包含详细的音频会话和编解码器信息

## 故障排除

如果测试页面无法正常工作：

1. **检查权限**: 确保已授予麦克风权限
2. **查看日志**: 检查错误信息和状态更新
3. **重启应用**: 重新启动应用尝试
4. **检查设备**: 确保设备麦克风正常工作

## 开发说明

这个测试页面是完全独立的，不会修改原有的 `real_audio_detector.dart` 文件。您可以：

- 安全地测试音频检测功能
- 调试编解码器兼容性问题
- 调整检测参数
- 验证 iOS 音频会话配置

测试完成后，原有的训练页面会继续使用优化后的音频检测功能。 